<div class="container-lg my-5  mx-3">
  <h1>My view on all my plans</h1>

<%# **************************************** %>

  <div class="m-3">
    <div class="m-3">
      <%= link_to new_plan_path(@plan), class: 'btn font-turquoise px-2' do %>
        <i class="fa-solid fa-plus"></i>&nbsp add plan
      <% end %>
    </div>


    <%# ******************* START Plans ******************* %>

    <div class="d-flex flex-row flex-wrap w-100">
      <% @plans.each do |plan| %>
        <div class="m-3 py-3" style="min-width:380px;max-width:380px">
          <div class="progress-bar"
             data-controller="progress-bar"
             data-progress-bar-target="progress"
             data-progress-bar-plans-value="<%=plan.tasks.size%>"
             data-progress-bar-completedplans-value="<%=plan.tasks.select{|task| task.completion}.size%>">
            <progress value="75" min="0" max="100"
                    style="visibility:hidden;height:0;width:0;"
                    data-progress-bar-target="circle">
            75%
            </progress>
          </div>

          <div class="mx-5">
            <h3>
              <%= link_to(plan_path(plan), class:'text-decoration-none text-dark')  do  %>
                <%= plan.name %>
                <%= link_to edit_plan_path(plan), class: 'btn text-warning' do %>
                    <i class="fa-solid fa-pen-to-square"></i>
                <% end %>
                <%= link_to plan_path(plan),
                              data: { turbo_method: :delete, turbo_confirm: "Are you sure?" },
                              class: 'btn text-danger px-2' do %>
                    <i class="fa-solid fa-xmark"></i>
                <% end %>
              <% end %>
            </h3>
            <p><%= plan.description %></p>
            <p class="fw-light"><small>Starting <%= plan.start_date.try(:strftime, "%d/%m/%Y") %> to <%= plan.end_date.try(:strftime, "%d/%m/%Y") %></small></p>
          </div>

          <div class="card-body">
            <% plan.tasks.each do |task|  %>
               <%= render 'tasks/task', task: task %>
            <% end %>
            <%= link_to new_plan_task_path(plan),class: 'btn font-turquoise px-2 ms-3' do %>
              <i class="fa-solid fa-plus"></i>&nbsp new task
            <% end %>
          </div>

        </div>
      <% end %>
    </div>
    <%# ******************** END Plans ******************** %>
  </div>

<%# **************************************** %>

  <div class="m-2">
    <%= link_to root_path, class: 'btn font-skyblue px-2' do %>
      <i class="fa-solid fa-chevron-left"></i>&nbsp home
    <% end %>
  </div>



</div>

<%# <script language="javascript">
setInterval(function(){
   window.location.reload(1);
}, 10000);
</script> %>
